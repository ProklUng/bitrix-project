#########
# Twig.
#########

services:
  # конфигурация по умолчанию в *этом* файле
  _defaults:
    autowire: true
    autoconfigure: true
    public: true

  # Twig loader
  twig.loader:
    class: Twig_Loader_Filesystem
    arguments: ['%kernel.project_dir%/local/twig/']

  # Twig
  twig:
    class: Local\Services\TwigService
    arguments: ['@twig.loader', '%debug%', '%kernel.project_dir%/bitrix/cache/twig']

  # Экземпляр Twig.
  twig.instance:
    class: Twig_Environment
    factory: ['@twig', 'instance']

  ##################
  # Twig extensions
  ##################
  debug.extension:
    class: Twig_Extension_Debug
    tags:
      - {name: twig.extension}

  # Супер-глобалы.
  Maximaster\Tools\Twig\PhpGlobalsExtension:
    tags:
      - {name: twig.extension}

  # Битриксовые функции.
  Maximaster\Tools\Twig\BitrixExtension:
    tags:
      - {name: twig.extension}

  # Различные хэлперы, связанные с сервис-контейнером.
  Local\Services\Twig\Extensions\ContainerTwigExtension:
    calls:
      - setContainer: ['@service_container']
    tags:
      - {name: twig.extension}